var B=Object.defineProperty;var T=(n,e,t)=>e in n?B(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var L=(n,e,t)=>T(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}})();let g,P;const h=8;let d=0,p=0,o=[],c=[],I=!1,S=0,k=0,m=()=>null;function F(n){return n[Math.floor(Math.random()*n.length)]}function u(n,e){return e*d+n}function W(n,e){let t=u(n,e);return o[t]!==null&&o[t].flammable}class v{constructor(e,t,s){L(this,"density");L(this,"colour");L(this,"flammable");this.density=e,this.colour=F(t),this.flammable=s}spread(e,t){return[]}move(e,t,s,l){let r=u(e,t),f=u(s,l),i=o[r],a=o[f];return i==null||a===null||a.density<i.density?(o[r]=a,o[f]=i,c.push([e,t]),c.push([s,l]),!0):!1}}function y(n,e){if(!W(n,e))return!1;let t=u(n,e);return o[t]=new x,c.push([n,e]),!0}class x extends v{constructor(){super(0,["#ff6600ff","#ee5500ff","#dd4400ff","#cc3300ff"],!1);L(this,"canSpread");L(this,"hasSpread");this.canSpread=!1,this.hasSpread=!1}spread(t,s){let l=[];this.canSpread=!1;for(let r=Math.max(0,s-1);r<=Math.min(p-1,s+1);r++)for(let f=Math.max(0,t-1);f<=Math.min(d-1,t+1);f++)W(f,r)&&(this.canSpread=!0),l.push([f,r]);return Math.random()<.1?[F(l)]:[]}move(t,s,l,r){y(l,r)&&(this.hasSpread=!0);let f=0;if(this.canSpread||(f+=.9,this.hasSpread&&(f+=.1)),Math.random()<f){let i=u(t,s);o[i]=null,c.push([t,s])}return!0}}class E extends v{constructor(){const e=["#ddddddff","#ccccccff","#bbbbbbff","#aaaaaaff"];super(1,e,!1)}}class X extends v{constructor(){const e=["#774400ff","#663300ff","#552200ff","#441100ff"];super(1,e,!0)}}class Y extends v{constructor(e,t,s){super(e,t,s)}spread(e,t){let s=[],l=[e,t+1],r=[e-1,t+1],f=[e+1,t+1],i=t<p-1,a=e>0,M=e<d-1;return i&&(s.push(l),a&&M?Math.random()<.5?s.push(r):s.push(f):a?s.push(r):M&&s.push(f)),s.push([e,t]),s}}class K extends Y{constructor(){const e=["#ffee00ff","#eedd00ff","#ddcc00ff","#ccbb00ff"];super(1,e,!1)}}class O extends v{constructor(e,t){super(e,t,!1)}spread(e,t){let s=[],l=[e,t+1],r=[e-1,t],f=[e+1,t],i=[e-1,t+1],a=[e+1,t+1],M=t<p-1,w=e>0,b=e<d-1;return M&&(s.push(l),w&&b?Math.random()<.5?s.push(i):s.push(a):w?s.push(i):b&&s.push(a)),w&&b?Math.random()<.5?s.push(r):s.push(f):w?s.push(r):b&&s.push(f),s.push([e,t]),s}}class z extends O{constructor(){const e=["#0000ffff","#0000eeff","#0000ddff","#0000ccff"];super(.5,e)}move(e,t,s,l){let r=u(e,t),f=u(s,l),i=o[r],a=o[f];if(a instanceof x)o[r]=null,o[f]=i,c.push([e,t]),c.push([s,l]);else if(a instanceof D)o[f]=new E,c.push([s,l]);else if(i==null||a===null||a.density<i.density)o[r]=a,o[f]=i,c.push([e,t]),c.push([s,l]);else return!1;return!0}}class R extends O{constructor(){const e=["#00ff00ff","#00ee00ff","#00dd00ff","#00cc00ff"];super(0,e)}move(e,t,s,l){let r=u(e,t),f=u(s,l),i=o[r],a=o[f];if(!(a instanceof R)){if(Math.random()<.02)return o[r]=null,o[f]!==null&&Math.random()<.8?o[f]=null:o[f]=i,c.push([e,t]),c.push([s,l]),!0;if(a===null)return o[r]=a,o[f]=i,c.push([e,t]),c.push([s,l]),!0}return!1}}class D extends O{constructor(){const e=["#dd3300ff","#cc2200ff","#bb1100ff","#aa0000ff"];super(.5,e)}move(e,t,s,l){let r=u(e,t),f=u(s,l),i=o[r],a=o[f];if(a===null)o[r]=a,o[f]=i,c.push([e,t]),c.push([s,l]);else if(a instanceof z)o[r]=new E,c.push([e,t]);else if(Math.random()<.02)y(s,l),c.push([s,l]);else return!1;return!0}}function j(n){switch(n){case"stone":m=()=>new E;break;case"wood":m=()=>new X;break;case"sand":m=()=>new K;break;case"water":m=()=>new z;break;case"acid":m=()=>new R;break;case"fire":m=()=>new x;break;case"lava":m=()=>new D;break;case"erase":default:m=()=>null;break}}function H(n,e,t,s){n=Math.floor(n/h),e=Math.floor(e/h);for(let l=n-t;l<=n+t;l++)for(let r=e-t;r<=e+t;r++)if(Math.sqrt((l-n)**2+(r-e)**2)<=t){let f=u(l,r);Math.random()<s&&(o[f]=m(),c.push([l,r]))}}function G(){I&&H(S,k,5,.1);for(let n=p-1;n>=0;n--)for(let e=0;e<d;e++){let t=u(e,n),s=o[t];if(s!==null){let l=s.spread(e,n);for(let r=0;r<l.length;r++){let[f,i]=l[r];if(s.move(e,n,f,i))break}}}}function N(){for(G();c.length>0;){let[n,e]=c.pop();if(n<d&&e<p){let t=o[u(n,e)];P.beginPath(),t===null?P.clearRect(n*h,e*h,h,h):(P.fillStyle=t.colour,P.fillRect(n*h,e*h,h,h)),P.stroke()}}requestAnimationFrame(N)}window.onload=()=>{g=document.getElementById("canvas"),P=g.getContext("2d"),o=new Array(d*p).fill(null);const n=()=>{let e=d,t=p;if(d=Math.floor(window.innerWidth/h),p=Math.floor(window.innerHeight/h),d!=e||p!=t){let s=new Array(d*p).fill(null);for(let l=0;l<Math.min(p,t);l++)for(let r=0;r<Math.min(d,e);r++)s[u(r,l)]=o[l*e+r];o=s}g.width=window.innerWidth,g.height=window.innerHeight;for(let s=0;s<p;s++)for(let l=0;l<d;l++)c.push([l,s])};n(),addEventListener("resize",n),g.addEventListener("mousedown",e=>{I=!0,S=e.offsetX,k=e.offsetY}),g.addEventListener("mousemove",e=>{if(I){let t=S,s=k,l=e.offsetX,r=e.offsetY,f=Math.abs(l-t),i=t<l?1:-1,a=-Math.abs(r-s),M=s<r?1:-1,w=f+a;for(;H(t,s,5,.1),!(t==l&&s==r);){let b=2*w;if(b>=a){if(t==l)break;w+=a,t+=i}if(b<=f){if(s==r)break;w+=f,s+=M}}S=e.offsetX,k=e.offsetY}}),g.addEventListener("mouseup",()=>{I=!1}),requestAnimationFrame(N)};var A;const q=(A=document.getElementById("type-buttons"))==null?void 0:A.children;var C;for(let n=0;n<q.length;n++)(C=q.item(n))==null||C.addEventListener("click",e=>{const s=e.target.innerText.toLowerCase();j(s)});
